# backend/utils/loader.py
import pandas as pd
from utils.db import get_connection

def load_data():
    conn = get_connection()
    cursor = conn.cursor()

    def fetch_df(query: str):
        cursor.execute(query)
        rows = cursor.fetchall()
        return pd.DataFrame(rows)

    science_data = fetch_df("SELECT * FROM science_scores")
    humanities_data = fetch_df("SELECT * FROM humanities_scores")
    passing_data = fetch_df("SELECT * FROM passing_grade")

    cursor.close()
    conn.close()
    return science_data, humanities_data, passing_data


